---
published: true
layout: post
title: python标准库-内置类型
category: python
tags: 
  - python
time: 2017.03.30 20:56:00
excerpt: 余弦:我没看过python的书，但我通读过python文档。文档不过一遍，视野会局限。近日读sqlmap源码，发现自己对于标准库所知甚少，想到knownsec技能表中余弦的一番话，加之最近有意提升English能力，遂意通读python2.7.13官方文档，去粗取精，译成中文，国内虽有一译站点已有翻译，但为参考。然本钱平平，词不达意，技止于此，望看客海涵。

---

余弦:我没看过python的书，但我通读过python文档。文档不过一遍，视野会局限。
近日读sqlmap源码，发现自己对于标准库所知甚少，想到knownsec技能表中余弦的一番话，加之最近有意提升English能力，遂意通读python2.7.13官方文档，去粗取精，译成中文，国内虽有一译站点已有翻译，但为参考。然本钱平平，词不达意，技止于此，望看客海涵。

<!--more-->

# Python标准库-内置类型
主要的内置类型有数字，序列，映射，文件，类，实例和异常。
某些对象类型支持一些操作；特别的，实际上所有对象都可以被比较，测试其真值与否，转换成string(用repr()或略有差异的str()函数，后者在print()函数写出该对象时被隐式调用)。

## 真值测试
任何对象都可以进行真值测试，使用if或while语句或下面的布尔操作符均可。下列的几种情况被认为是false：
- None
- False
- 数字类型的0，比如0,0L,0.0,0j
- 空的序列，比如'',(),[]。
- 空的映射，比如{}
- 用户定义类的实例，如果这个类定义了一个`__nonzero__()`或`__len__()`方法，且该方法返回的是0或布尔值False。

其他的所有值都被认为是true——因此大部分的对象一般都是true。
操作符和内置函数当需要返回一个布尔值时，往往返回0或者False来代表false，返回1或True来代表true，除非有其他规定（一个重要的差异：布尔操作符or和and总是返回操作数中的一个）。

## 布尔操作符——and,or,not
以下是bool操作符，按优先级升序排列：

| 操作符 | 结果 | 注意 |
| ----- | ----- | ---- |
| x or y | 如果x是false，则返回y，否则返回x | 短路操作符，当x为false时，才会执行y |
| x and y | 如果x是false，则返回x，否则返回y | 短路操作符，当x为true时，才会执行y |
| not x | 如果x是false，则返回True，否则返回False | not相比较其他非布尔操作符优先级较低，因此`not a==b`相当于not(a==b)，而`a==not b`是语法错误 |

## 比较
所有对象均支持比较操作符。它们拥有相同的优先级（高于布尔操作符）。比较可以写成链式；比如`x < y <= z`和`x<y and y<=z`等价（除了y只执行了一次外，且如果x<y是false的话，两个语句都不会执行z，即短路效应）。

| 操作符 | 意义 |
| ----- | ----- |
| < | 小于 |
| <= | 小于等于 |
| > | 大于 |
| >= | 大于等于 |
| == | 等于 |
| != | 不等于 |
| is | 对象一致 |
| is not | 对象不一致 |

注意：!=也可以写成<>，但这是为了向前兼容。新的代码应该使用!=。

不同类型对象，除了不同的数字类型和字符串类型，永远不要测试相等。这样的对象排序结果永远一致但顺序是随机的（使得异构数组的排序可以生成一致的结果）。此外，某些类型（比如file）只支持退化的比较概念，该类型的两个对象任意之间互不相等。同理，这些对象的排序是一致的但顺序随机。当任意一个操作数是复数时，<、>、=、>=运算符都会抛TypeError。

不同身份的类实例通常不等，除非该类定义了一个`__eq__()`方法或`__cmp__()`方法。

类实例通常不能与该类的其他实例或其他类型的对象进行排序，除非该类定义了足够的富比较方法(`__lt__()`,`__le__()`,`__gt__()`,`__ge__()`)或`__cmp__()`方法。

> C python实现细节：不同类型对象除了数字型，都是通过类型名字来排序。同类型的对象，如果本身不支持比较，则以地址排序。

两个具有等优先级的操作符，in和not in，仅序列类型支持。

# 待续。。。